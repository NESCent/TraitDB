<div class="row-fluid">
  <div class="offset1 span10">
    <div class="row-fluid">
      <h2>Search</h2>
      <!--<p class="lead">Number of records available: <span id="available"><%= 5  -%></span> out of <span id="total"><%= 423 %></span></p>-->
    </div>
    <div class="row-fluid">
      <div id="searchform" class="well">
        <%= form_tag '/search/results', { :class => 'form' } do -%>
            <!-- taxon selection, should be a partial? -->
            <div id="taxa">
              <h3>Taxonomy</h3>
              <div class="row-fluid">
                <div class="span10">
                  <div class="row-fluid">
                    <% @iczn_groups.each do |group| %>
                      <!-- how many spans will fit? -->
                      <label><%= group.name %></label>
                    <% end %>
                  </div>
                </div>
              </div>
              <div class="row-fluid taxon-filter-row">
                <div class="span10">
                  <div class="row-fluid">
                    <% @iczn_groups.each do |group| %>
                      <%= select_tag("#{group.name}[0]",
                                     options_from_collection_for_select(group.taxa.sorted, 'id', 'name'),
                                     'data-groupid' => group.id,
                                     'data-groupname' => group.name,
                                     'data-grouplevel' => group.level
                          ) %>
                    <% end %>
                  </div>
                </div>
                <div class="span2 add_remove_taxon">
                  <a href="#" class="btn add_taxon"><i class="icon-plus-sign"></i></a>
                  <a href="#" class="btn remove_taxon"><i class="icon-minus-sign"></i></a>
                </div>
              </div>
            </div>
            <div id="traits">
              <h3>Traits</h3>
              <div class="row-fluid">
                <div class="span1">

                </div>
                <div class="span9">
                  <div class="row-fluid">
                    <label class="span3">Type</label>
                    <label class="span3">Name</label>
                    <label class="span3">Value</label>
                  </div>
                </div>
              </div>

              <div class="row-fluid trait-filter-row">
                <div class="span1 operator_placeholder"></div>
                <div class="span9">
                  <div class="row-fluid">
                    <%= select_tag(:"#{:trait_types}[0]", options_for_select(@trait_types), :prompt => '-- Select --', :class => 'span3 trait_type') %>
                    <%= select_tag(:"#{:categorical_trait_name}[0]", nil, :prompt => '-- Select --', :class => 'span3 categorical_trait_name') %>
                    <%= select_tag("#{:categorical_trait_values}[0]", nil, :prompt => '-- All Values --', :class => 'span3 categorical_trait_values') %>
                    <%= select_tag(:"#{:continuous_trait_name}[0]", nil, :prompt => '-- Select --', :class => 'span3 continuous_trait_name') %>
                    <%= select_tag("#{:continuous_trait_value_predicates}[0]", nil, :prompt => '-- All Values --', :class => 'span3 continuous_trait_value_predicates') %>
                    <%= number_field_tag("#{:continuous_trait_entries}[0]", nil, :class => 'span3 continuous_trait_entries') %>
                  </div>
                </div>
                <div class="span2">
                  <a href="#" class="btn add_trait"><i class="icon-plus-sign"></i></a>
                  <a href="#" class="btn remove_trait"><i class="icon-minus-sign"></i></a>
                </div>
              </div>
            </div>
          <div id="options">
            <div class="row-fluid options-row">
              <label class="checkbox inline">
                <input type="checkbox" id="only_rows_with_data" name="only_rows_with_data">Only include rows with data for chosen traits
              </label>
            </div>
            <div class="row-fluid options-row">
              <label class="checkbox inline">
                <input type="checkbox" id="include_references" name="include_references" checked>Include references
              </label>
            </div>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn btn-primary pull-right">Search <i class="icon-search icon-white"></i></button>
            <button type="reset" id="reset_search" class="btn btn-link pull-right">Reset</button>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
    var icznGroups = <%= raw @iczn_groups.to_json %>;
    $(document).ready(function() {
        // add button handlers
        addButtonHandlers();
        addSelectionChangeListeners();
        hideContinuousFields();
    });
</script>
